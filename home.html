<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Occupational Health and Safety Procedures - Computer System Servicing</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Splash Screen removed -->
    <div class="main-wrapper">
        <!-- Header -->
        <header class="header small-header">
            <div class="header-container">
                <h1 class="header-title">Occupational Health and Safety Procedures - CSS</h1>
            </div>
        </header>
        <div id="greeting" class="greeting-block" style="display:flex;justify-content:center;">
            <!-- Greeting will be injected here -->
        </div>

        <!-- Main Content Area -->
    <main class="main-content" role="main" aria-label="Main content area">
            <section class="intro-block" aria-labelledby="intro-title">
                <h2 id="intro-title" class="main-title">Occupational Health & Safety</h2>
                <p class="main-desc">Learn essential safety procedures for Computer System Servicing to protect yourself and others in the workplace.</p>
            </section>

            <!-- Quick Stats -->
            <section class="stats-row" aria-label="Quick statistics">
                <article class="stat-card" tabindex="0" role="region" aria-labelledby="lessons-label completed-lessons">
                    <div class="stat-icon"><img src="src/book.png" alt="Lessons" class="stat-img" aria-hidden="true"></div>
                    <div class="stat-info">
                        <p id="lessons-label" class="stat-label">Lessons</p>
                        <p id="completed-lessons" class="stat-value" aria-live="polite" aria-atomic="true">0/7</p>
                    </div>
                </article>
                <article class="stat-card" tabindex="0" role="region" aria-labelledby="checklist-label completed-checklist">
                    <div class="stat-icon"><img src="src/checklist1.png" alt="Checklist" class="stat-img" aria-hidden="true"></div>
                    <div class="stat-info">
                        <p id="checklist-label" class="stat-label">Checklist</p>
                        <p id="completed-checklist" class="stat-value" aria-live="polite" aria-atomic="true">0/24</p>
                    </div>
                </article>
            </section>

            <!-- Progress Bar -->
            <section class="progress-block" aria-label="Progress bar">
                <div class="progress-labels">
                    <span class="progress-label">Overall Progress</span>
                    <span class="progress-value" id="progress-percent" aria-live="polite" aria-atomic="true">0%</span>
                </div>
                <div class="progress-bar-bg" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Progress bar">
                    <div id="progress-bar" class="progress-bar" style="width:0%"></div>
                </div>
            </section>


            <!-- Feature Cards -->
            <section class="feature-row" aria-label="Feature cards">
                <a href="lessons.html" class="feature-card" role="link" tabindex="0" aria-describedby="desc-educational-content">
                    <div class="feature-icon"><img src="src/lesson.png" alt="Educational Content" class="feature-img" aria-hidden="true"></div>
                    <div class="feature-info">
                        <h3 class="feature-title" id="title-educational-content">Educational Content</h3>
                        <p class="feature-desc" id="desc-educational-content">Learn OHS procedures for CSS</p>
                    </div>
                </a>
                <a href="checklist.html" class="feature-card" role="link" tabindex="0" aria-describedby="desc-safety-checklist">
                    <div class="feature-icon"><img src="src/checklist2.png" alt="Safety Checklist" class="feature-img" aria-hidden="true"></div>
                    <div class="feature-info">
                        <h3 class="feature-title" id="title-safety-checklist">Safety Checklist</h3>
                        <p class="feature-desc" id="desc-safety-checklist">Track your safety procedures</p>
                    </div>
                </a>
                <a href="assessment.html" class="feature-card" role="link" tabindex="0" aria-describedby="desc-assessment">
                    <div class="feature-icon"><img src="src/assessment.png" alt="Assessment" class="feature-img" aria-hidden="true"></div>
                    <div class="feature-info">
                        <h3 class="feature-title" id="title-assessment">Assessment</h3>
                        <p class="feature-desc" id="desc-assessment">Test your knowledge</p>
                    </div>
                </a>
            </section>
        </main>
        <!-- Mobile Icon Navigation Bar -->
        <nav class="bottom-nav">
            <a href="home.html" class="nav-link active">
                <img src="src/home.png" alt="Home" class="nav-img">
                <span class="nav-label">Home</span>
            </a>
            <a href="lessons.html" class="nav-link">
                <img src="src/book.png" alt="Lessons" class="nav-img">
                <span class="nav-label">Lessons</span>
            </a>
            <a href="checklist.html" class="nav-link">
                <img src="src/checklist1.png" alt="Checklist" class="nav-img">
                <span class="nav-label">Checklist</span>
            </a>
            <a href="assessment.html" class="nav-link">
                <img src="src/assessment.png" alt="Assessment" class="nav-img">
                <span class="nav-label">Assessment</span>
            </a>
            <a href="settings.html" class="nav-link">
                <img src="src/settings.png" alt="Settings" class="nav-img">
                <span class="nav-label">Settings</span>
            </a>
        </nav>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Palette system: apply palette from localStorage
        function setPalette(palette) {
            document.documentElement.classList.remove('palette-light', 'palette-dark', 'palette-pastel1', 'palette-pastel2', 'palette-pastel3');
            document.documentElement.classList.add('palette-' + palette);
        }
        const savedPalette = localStorage.getItem('palette');
        setPalette(savedPalette ? savedPalette : 'light');

        // Greeting logic
        function showGreeting() {
            let name = 'Guest';
            let image = null;
            const userData = localStorage.getItem('userData');
            if (userData) {
                try {
                    const parsed = JSON.parse(userData);
                    if (parsed.name) name = parsed.name;
                    if (parsed.image) image = parsed.image;
                } catch (e) {}
            }
            const initial = name && name.length > 0 ? name.trim()[0].toUpperCase() : 'G';
            const avatarHtml = image
                ? `<img src="${image}" alt="Learner Photo" class="greeting-avatar" style="object-fit:cover;">`
                : `<div class="greeting-avatar">${initial}</div>`;
            document.getElementById('greeting').innerHTML = `
                <div class="greeting-card">
                    ${avatarHtml}
                    <div class="greeting-texts">
                        <div class="greeting-title">Hello, ${name}!</div>
                        <div class="greeting-sub">Welcome to your OHS learning dashboard.</div>
                    </div>
                </div>
            `;
        }
        showGreeting();

        // Stats logic
        function getLessonsProgress() {
            const lessons = JSON.parse(localStorage.getItem('lessons')) || { completed: [] };
            return lessons.completed.length;
        }
        function getChecklistProgress() {
            const checklist = JSON.parse(localStorage.getItem('checklist')) || { items: [] };
            return checklist.items.filter(i => i.completed).length;
        }
        function getQuizScore() {
            const quizHistory = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            if (quizHistory.length === 0) return 'No attempts yet';
            for (let i = quizHistory.length - 1; i >= 0; i--) {
                let perc = quizHistory[i].percentage;
                if (perc !== undefined && perc !== null && perc !== '') {
                    if (typeof perc === 'string') {
                        perc = perc.replace('%','');
                        if (!isNaN(perc)) return perc + '%';
                    } else if (typeof perc === 'number') {
                        return perc + '%';
                    }
                }
            }
            return 'No attempts yet';
        }
        function updateStats() {
            const lessons = getLessonsProgress();
            const checklist = getChecklistProgress();
            const total = 7 + 24;
            const percent = Math.round(((lessons + checklist) / total) * 100);
            document.getElementById('completed-lessons').textContent = lessons + '/7';
            document.getElementById('completed-checklist').textContent = checklist + '/24';
            document.getElementById('progress-percent').textContent = percent + '%';
            document.getElementById('progress-bar').style.width = percent + '%';
            var quizScoreElem = document.getElementById('quiz-score');
            if (quizScoreElem) {
                quizScoreElem.textContent = getQuizScore();
            }
        }
        updateStats();
        window.addEventListener('storage', function(e) {
            if (e.key === 'quizHistory' || e.key === 'lessons' || e.key === 'checklist') {
                updateStats();
            }
        });
    });
</script>

</body>


</html>